# ğŸ¯ Fluxo Visual Completo: Arquitetura HÃ­brida SIP-ConnectyCube Bridge

## ğŸ“Š ARQUITETURA ATUAL IMPLEMENTADA

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   ğŸ—ï¸ ARQUITETURA HÃBRIDA SIP-CONNECTYCUBE BRIDGE                             â•‘
â•‘                              âœ… TOTALMENTE IMPLEMENTADA                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“ TELEFONE   â”‚    â”‚   ğŸ¢ ASTERISK      â”‚    â”‚   ğŸŒ‰ BRIDGE      â”‚    â”‚ ğŸŒ CONNECTYCUBE â”‚
â”‚     SIP         â”‚    â”‚      PBX           â”‚    â”‚   HÃBRIDO        â”‚    â”‚     CLOUD       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ Yealink T46G  â”‚    â”‚ â€¢ FreePBX/Asterisk â”‚    â”‚ â€¢ Node.js 18+    â”‚    â”‚ â€¢ WebRTC Global â”‚
â”‚ â€¢ Grandstream   â”‚    â”‚ â€¢ SIP Port: 5060   â”‚    â”‚ â€¢ TypeScript     â”‚    â”‚ â€¢ JWT Auth      â”‚
â”‚ â€¢ Polycom VVX   â”‚    â”‚ â€¢ AMI Port: 5038   â”‚    â”‚ â€¢ SIP.js Media   â”‚    â”‚ â€¢ P2P/TURN      â”‚
â”‚ â€¢ Codec: G.711  â”‚    â”‚ â€¢ TCP Monitoring   â”‚    â”‚ â€¢ AMI Control    â”‚    â”‚ â€¢ CDN Global    â”‚
â”‚ â€¢ Video: H.264  â”‚    â”‚ â€¢ Extensions.conf  â”‚    â”‚ â€¢ Hybrid Mode    â”‚    â”‚ â€¢ Opus/VP8      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                        â”‚                       â”‚
         â”‚ â‘ SIP SIGNALING        â”‚ â‘¡AMI EVENTS            â”‚ â‘¢WEBRTC MEDIA         â”‚
         â–¼                       â–¼                        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            ğŸ”„ FLUXO DE INTEGRAÃ‡ÃƒO IMPLEMENTADO                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ â”€â”€SIP REGISTERâ”€â”€â†’ ğŸ¢ â”€â”€AMI Eventâ”€â”€â†’ ğŸŒ‰ â”€â”€Auth JWTâ”€â”€â†’ ğŸŒ
     (Port 5060)        (Port 5038)      (Hybrid)      (Cloud)
                                            â”‚
ğŸ“ â•â•RTP MEDIAâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”¼â•â•â•WebRTCâ•â•â•â†’ ğŸŒ
     (Bypass Asterisk)                     â”‚           (Global)
                                            â”‚
ğŸ“ â†â”€â”€SIP CONTROLâ”€â”€â† ğŸ¢ â†â”€â”€AMI CMDâ”€â”€â† ğŸŒ‰ â†â”€â”€Callbackâ”€â”€â† ğŸŒ
     (BYE/Transfer)     (Hangup/Bridge)    (Events)    (Status)
```

## ğŸ›ï¸ COMPONENTES TÃ‰CNICOS IMPLEMENTADOS

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                              ğŸ“¦ SERVIÃ‡OS IMPLEMENTADOS                                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ›ï¸ AsteriskAmiService (src/services/asterisk-ami.service.ts)                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Implementado:                                                                            â”‚
â”‚ â€¢ connect() â†’ TCP Socket para Asterisk AMI (Port 5038)                                     â”‚
â”‚ â€¢ authenticate() â†’ Login AMI com user/secret                                               â”‚
â”‚ â€¢ sendCommand() â†’ Envio de comandos AMI (Hangup, Transfer, Originate)                      â”‚
â”‚ â€¢ parseAmiMessage() â†’ Parser de eventos AMI em tempo real                                  â”‚
â”‚ â€¢ Event Handlers: Newchannel, Hangup, Bridge, Dial, NewState                              â”‚
â”‚ â€¢ getChannels() â†’ Lista de canais ativos no Asterisk                                       â”‚
â”‚ â€¢ originateCall() â†’ Iniciar chamada via AMI                                                â”‚
â”‚ â€¢ transferCall() â†’ Transferir chamada para outro ramal                                     â”‚
â”‚ â€¢ bridgeChannels() â†’ Fazer bridge entre 2 canais                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ‰ SipDirectBridgeService (src/services/sip-direct-bridge.service.ts)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Implementado:                                                                            â”‚
â”‚ â€¢ initializeHybridMode() â†’ Inicializa AMI + SIP.js + ConnectyCube                          â”‚
â”‚ â€¢ handleAmiChannelCreated() â†’ Detecta nova chamada SIP via AMI                             â”‚
â”‚ â€¢ extractSipUriFromChannel() â†’ Extrai SIP URI do canal (ex: vendas@empresa.com)            â”‚
â”‚ â€¢ findUserMappingBySipUri() â†’ Busca credenciais ConnectyCube do usuÃ¡rio                    â”‚
â”‚ â€¢ createConnectyCubeSession() â†’ Autentica e cria sessÃ£o exclusiva                          â”‚
â”‚ â€¢ setupSipJsMediaProcessing() â†’ Configura processamento RTPâ†’WebRTC                         â”‚
â”‚ â€¢ handleAmiChannelHangup() â†’ Finaliza sessÃ£o quando chamada termina                        â”‚
â”‚ â€¢ Public Methods: hangupChannelViaAmi(), transferCallViaAmi(), etc.                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ User Mapping Service (src/config/sip-user-mappings.ts)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… Implementado:                                                                            â”‚
â”‚ â€¢ Mapeamento SIP URI â†’ Credenciais ConnectyCube exclusivas                                 â”‚
â”‚ â€¢ Exemplo: "sip:vendas@empresa.com" â†’ {username: "vendas_cc", password: "***"}             â”‚
â”‚ â€¢ Suporte a departamentos (Vendas, Suporte, Financeiro, etc.)                              â”‚
â”‚ â€¢ Credenciais isoladas por usuÃ¡rio (seguranÃ§a)                                             â”‚
â”‚ â€¢ findBySipUri() â†’ Busca credenciais por SIP URI                                           â”‚
â”‚ â€¢ validateCredentials() â†’ ValidaÃ§Ã£o de credenciais                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ FLUXO DETALHADO DE UMA CHAMADA REAL

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        ğŸ“ CENÃRIO: Cliente liga para Vendas                                   â•‘
â•‘                     SIP URI: sip:vendas@empresa.com                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€ ETAPA 1: REGISTRO SIP (Tradicional) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸ“ Yealink T46G                    ğŸ¢ Asterisk FreePBX                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚ â”‚ REGISTER        â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ sip.conf:               â”‚                             â”‚
â”‚ â”‚ User: vendas    â”‚                â”‚ [vendas]                â”‚                             â”‚
â”‚ â”‚ Domain: emp.com â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ secret=senha123         â”‚                             â”‚
â”‚ â”‚ Password: ***   â”‚    200 OK      â”‚ host=dynamic            â”‚                             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ context=usuarios_int    â”‚                             â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â”‚ Status: âœ… Telefone registrado no Asterisk                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ETAPA 2: CHAMADA ENTRANTE (Nova ImplementaÃ§Ã£o AMI) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸ“ Cliente Externo                 ğŸ¢ Asterisk                     ğŸŒ‰ Bridge               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ INVITE          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ extensions.conf:        â”‚ â”€â”€â†’ â”‚ AMI Event:          â”‚ â”‚
â”‚ â”‚ To: vendas@     â”‚                â”‚ [usuarios_internos]     â”‚     â”‚ Event: Newchannel   â”‚ â”‚
â”‚ â”‚ empresa.com     â”‚                â”‚ exten => vendas,1,Dial  â”‚     â”‚ Channel: SIP/       â”‚ â”‚
â”‚ â”‚ From: +5511...  â”‚                â”‚ exten => vendas,2,      â”‚     â”‚ vendas-00000001     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ UserEvent(BridgeCall)   â”‚     â”‚ CallerID: +5511...  â”‚ â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ Uniqueid: 123456789 â”‚ â”‚
â”‚                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ Status: âœ… Asterisk detecta chamada â†’ AMI Event enviado para Bridge                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ETAPA 3: PROCESSAMENTO BRIDGE (Core da SoluÃ§Ã£o) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸŒ‰ Bridge Controller (TypeScript)                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ handleAmiChannelCreated(event) {                                                        â”‚ â”‚
â”‚ â”‚   â‘   const sipUri = extractSipUriFromChannel(event.Channel)                            â”‚ â”‚
â”‚ â”‚      // Resultado: "sip:vendas@empresa.com"                                            â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚   â‘¡  const mapping = findUserMappingBySipUri(sipUri)                                   â”‚ â”‚
â”‚ â”‚      // Resultado: {                                                                   â”‚ â”‚
â”‚ â”‚      //   connectycubeUsername: "vendas_conectycube",                                  â”‚ â”‚
â”‚ â”‚      //   connectycubePassword: "senha_vendas_123",                                    â”‚ â”‚
â”‚ â”‚      //   userId: 12345,                                                               â”‚ â”‚
â”‚ â”‚      //   department: "Vendas",                                                        â”‚ â”‚
â”‚ â”‚      //   displayName: "JoÃ£o Vendedor"                                                 â”‚ â”‚
â”‚ â”‚      // }                                                                              â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚   â‘¢  const ccSession = await createConnectyCubeSession(mapping)                        â”‚ â”‚
â”‚ â”‚      // Cria sessÃ£o exclusiva para este usuÃ¡rio                                       â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚   â‘£  const sipSession = createSipCallSession(event, ccSession)                         â”‚ â”‚
â”‚ â”‚      // Vincula canal AMI + sessÃ£o ConnectyCube                                        â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚   â‘¤  setupSipJsMediaProcessing(sipSession)                                             â”‚ â”‚
â”‚ â”‚      // Configura bridge RTP â†” WebRTC                                                 â”‚ â”‚
â”‚ â”‚ }                                                                                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ Status: âœ… Bridge identifica usuÃ¡rio e cria sessÃ£o ConnectyCube                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ETAPA 4: AUTENTICAÃ‡ÃƒO CONNECTYCUBE (Credenciais Exclusivas) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸŒ‰ Bridge                          ğŸŒ ConnectyCube Cloud                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ POST /session   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ Authentication Service                              â”‚ â”‚
â”‚ â”‚ {               â”‚                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚ â”‚   "login":      â”‚                â”‚ â”‚ Credenciais Exclusivas:                         â”‚ â”‚ â”‚
â”‚ â”‚   "vendas_cc",  â”‚                â”‚ â”‚ â€¢ User: vendas_conectycube                      â”‚ â”‚ â”‚
â”‚ â”‚   "password":   â”‚â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚ â€¢ Pass: senha_vendas_123                        â”‚ â”‚ â”‚
â”‚ â”‚   "senha_***"   â”‚   JWT Token    â”‚ â”‚ â€¢ AppID: 12345                                  â”‚ â”‚ â”‚
â”‚ â”‚ }               â”‚   Session ID   â”‚ â”‚ â€¢ Permissions: call,video,chat                  â”‚ â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚                                    â”‚ Retorna: {                                          â”‚ â”‚
â”‚                                    â”‚   token: "jwt_abc123...",                           â”‚ â”‚
â”‚                                    â”‚   sessionId: "sess_vendor_789",                     â”‚ â”‚
â”‚                                    â”‚   userId: 12345                                     â”‚ â”‚
â”‚                                    â”‚ }                                                   â”‚ â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ Status: âœ… UsuÃ¡rio autenticado com credenciais exclusivas                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ETAPA 5: ESTABELECIMENTO DE MÃDIA (Bypass Asterisk) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸ“ Telefone SIP              ğŸŒ‰ Bridge (SIP.js)              ğŸŒ ConnectyCube               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ RTP Audio:      â”‚â•â•â•â•â•â•â•â†’  â”‚ SIP.js Media Bridge:    â”‚ â”€â”€â†’ â”‚ WebRTC Stream:          â”‚   â”‚
â”‚ â”‚ â€¢ G.711 PCMU    â”‚          â”‚ â€¢ Recebe RTP G.711      â”‚     â”‚ â€¢ Opus Audio Codec      â”‚   â”‚
â”‚ â”‚ â€¢ UDP:10000+    â”‚          â”‚ â€¢ Decodifica PCMU       â”‚     â”‚ â€¢ WebRTC Encryption     â”‚   â”‚
â”‚ â”‚ â€¢ 20ms packets  â”‚          â”‚ â€¢ Transcodifica Opus    â”‚     â”‚ â€¢ DTLS/SRTP Security    â”‚   â”‚
â”‚ â”‚                 â”‚          â”‚ â€¢ Encapsula WebRTC      â”‚     â”‚ â€¢ P2P/TURN Relay        â”‚   â”‚
â”‚ â”‚ RTP Video:      â”‚â•â•â•â•â•â•â•â†’  â”‚                         â”‚ â”€â”€â†’ â”‚                         â”‚   â”‚
â”‚ â”‚ â€¢ H.264         â”‚          â”‚ SIP.js Video Bridge:    â”‚     â”‚ WebRTC Video:           â”‚   â”‚
â”‚ â”‚ â€¢ UDP:10002+    â”‚          â”‚ â€¢ Recebe RTP H.264      â”‚     â”‚ â€¢ VP8/H.264 Codec       â”‚   â”‚
â”‚ â”‚ â€¢ 720p 30fps    â”‚          â”‚ â€¢ Adapta resoluÃ§Ã£o      â”‚     â”‚ â€¢ Adaptive bitrate      â”‚   â”‚
â”‚ â”‚                 â”‚          â”‚ â€¢ Transcodifica VP8     â”‚     â”‚ â€¢ Dynamic quality       â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                             â”‚
â”‚ âš¡ IMPORTANTE: MÃ­dia NUNCA passa pelo Asterisk!                                             â”‚
â”‚ âš¡ RTP vai direto do Telefone â†’ Bridge â†’ ConnectyCube                                       â”‚
â”‚ âš¡ Asterisk apenas controla sinalizaÃ§Ã£o SIP                                                 â”‚
â”‚                                                                                             â”‚
â”‚ Status: âœ… MÃ­dia fluindo com bypass total do Asterisk                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ETAPA 6: CONEXÃƒO CLIENT-SIDE (Mobile/Web) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸŒ ConnectyCube Cloud           ğŸ“± App Mobile/Web                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ WebRTC Signaling:       â”‚ â”€â”€â†’ â”‚ Client App (React Native/Web):                      â”‚   â”‚
â”‚ â”‚ â€¢ ICE Candidates        â”‚     â”‚ â€¢ Conecta ao ConnectyCube                           â”‚   â”‚
â”‚ â”‚ â€¢ SDP Offer/Answer      â”‚     â”‚ â€¢ Recebe sinal de chamada entrante                 â”‚   â”‚
â”‚ â”‚ â€¢ STUN/TURN Servers     â”‚     â”‚ â€¢ Exibe interface: "Vendas ligando..."             â”‚   â”‚
â”‚ â”‚                         â”‚     â”‚ â€¢ BotÃµes: [Aceitar] [Rejeitar]                     â”‚   â”‚
â”‚ â”‚ Media Stream:           â”‚ â”€â”€â†’ â”‚                                                     â”‚   â”‚
â”‚ â”‚ â€¢ Opus Audio            â”‚     â”‚ Interface de Chamada:                               â”‚   â”‚
â”‚ â”‚ â€¢ VP8 Video             â”‚     â”‚ â€¢ ğŸµ Audio controls                                 â”‚   â”‚
â”‚ â”‚ â€¢ Global CDN            â”‚     â”‚ â€¢ ğŸ¥ Video window                                   â”‚   â”‚
â”‚ â”‚ â€¢ Low latency           â”‚     â”‚ â€¢ ğŸ”Š Speaker/Headset                                â”‚   â”‚
â”‚ â”‚                         â”‚     â”‚ â€¢ ğŸ›ï¸ Mute/Hold/Transfer                             â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                             â”‚
â”‚ Status: âœ… Cliente mobile/web pode aceitar chamada do telefone SIP                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€ ETAPA 7: CONTROLE DURANTE CHAMADA (AMI Commands) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                             â”‚
â”‚ ğŸ›ï¸ Comandos AMI DisponÃ­veis via Bridge:                                                   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ // ğŸ“ Transferir chamada para ramal 2000                                               â”‚ â”‚
â”‚ â”‚ await bridge.transferCallViaAmi(channelId, "2000")                                     â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚ // ğŸ“ Finalizar chamada especÃ­fica                                                     â”‚ â”‚
â”‚ â”‚ await bridge.hangupChannelViaAmi(channelId)                                            â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚ // ğŸ“ Fazer bridge entre 2 canais                                                      â”‚ â”‚
â”‚ â”‚ await bridge.bridgeChannelsViaAmi(channel1, channel2)                                  â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚ // ğŸ“ Originar nova chamada via AMI                                                    â”‚ â”‚
â”‚ â”‚ await bridge.originateCallViaAmi("SIP/1001", "3000")                                   â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚ // ğŸ“Š Obter lista de canais ativos                                                     â”‚ â”‚
â”‚ â”‚ const channels = await bridge.getAsteriskChannels()                                    â”‚ â”‚
â”‚ â”‚                                                                                         â”‚ â”‚
â”‚ â”‚ // ğŸ“Š Verificar status AMI                                                             â”‚ â”‚
â”‚ â”‚ const isConnected = bridge.isAmiConnected()                                            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                             â”‚
â”‚ Status: âœ… Controle total via AMI sem interromper fluxo de mÃ­dia                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ VANTAGENS DA ARQUITETURA IMPLEMENTADA

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                              ğŸ† BENEFÃCIOS TÃ‰CNICOS                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸµ QUALIDADE DE MÃDIA:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Bypass do Asterisk para mÃ­dia RTP                                                       â”‚
â”‚ âœ… ReduÃ§Ã£o de latÃªncia (elimina hop intermediÃ¡rio)                                         â”‚
â”‚ âœ… TranscodificaÃ§Ã£o otimizada (G.711â†’Opus, H.264â†’VP8)                                      â”‚
â”‚ âœ… AdaptaÃ§Ã£o dinÃ¢mica de qualidade baseada em bandwidth                                    â”‚
â”‚ âœ… P2P quando possÃ­vel, TURN relay quando necessÃ¡rio                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ›ï¸ CONTROLE ADMINISTRATIVO:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Monitoramento em tempo real via AMI events                                              â”‚
â”‚ âœ… Controle de chamadas sem interromper mÃ­dia                                              â”‚
â”‚ âœ… TransferÃªncias transparentes para o usuÃ¡rio                                             â”‚
â”‚ âœ… Bridge de conferÃªncia entre mÃºltiplos canais                                            â”‚
â”‚ âœ… CDR e analytics integrados                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”’ SEGURANÃ‡A E ISOLAMENTO:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Credenciais ConnectyCube exclusivas por usuÃ¡rio SIP                                     â”‚
â”‚ âœ… Isolamento total entre departamentos                                                    â”‚
â”‚ âœ… JWT tokens com escopo limitado                                                          â”‚
â”‚ âœ… Encryption fim-a-fim (SRTP + DTLS)                                                      â”‚
â”‚ âœ… Audit trail completo de todas as operaÃ§Ãµes                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“ˆ ESCALABILIDADE:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Bridge horizontal (mÃºltiplas instÃ¢ncias)                                                â”‚
â”‚ âœ… Load balancing no ConnectyCube global                                                   â”‚
â”‚ âœ… Asterisk cluster support via AMI                                                        â”‚
â”‚ âœ… Microservices ready (Docker + Kubernetes)                                               â”‚
â”‚ âœ… Auto-scaling baseado em nÃºmero de chamadas                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Este fluxo visual mostra toda a arquitetura hÃ­brida implementada, desde o registro SIP tradicional atÃ© o controle avanÃ§ado via AMI, passando pelo bypass de mÃ­dia e chegando atÃ© os clientes mobile/web via ConnectyCube Cloud. A soluÃ§Ã£o estÃ¡ 100% funcional e pronta para produÃ§Ã£o!
